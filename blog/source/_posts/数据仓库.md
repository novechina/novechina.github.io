---
title: flink的CDC技术
date: 2022-01-01 09:25:00
author: nove
categories: 大数据
tags:
  - 数据仓库
  - 维度建模
---
# 数据仓库

## 概念

* 什么是数据仓库
  * 存放数据的对象：特点：
  * 面像主题：不同场景有不同的主题域
  * 集成的：多个源头，做归一化处理
  * 随时间变化的：时间内有效的局限性
  * 非易失的：可以稳定保存
* 主题
  * 可以通过某个关键字关联起来的一系列表
* 粒度
  * 最小粒度原则，可以原子的反应某个或者某组行为的概念
  * 上卷：粒度变大
  * 下钻：粒度变小
* 维度
  * 研究行为的角度
  * 好的模型在于已经有的维度满足对模型的需求

## 设计数据仓库

## 选型

* 硬件
  * ssd，机械，云
* 软件
  * olap引擎，存储引擎，调度，管理

## 数据流程

* 集成
  * 兼容历史
  * 不同数据源的口径统一
  * 主题域划分
  * 时间语义设计
* 模型设计
  * 概念模型
    * 数据界限划分，主题划分
    * 确定实体，关系，主题域
  * 逻辑模型
    * 关系梳理，带入表相关内容
    * 梳理主题域间的关系
  * 物理模型
    * 粒度，分区，冗余的设计和取舍
    * 落地规划，满足可靠，效率的综合要求
    * 规范化&反规范化
      * k-v的格式存储-具体需求
      * 宽表的格式-冗余，性能问题
      * 索引构建-MPP类型引擎考虑分区问题
      * 使用频率划分-资源分配问题，热数据，冷数据

## 元数据

* 概念
  * 不包含数据信息，用来描述数据的数据
  * 数据结构信息
  * etl操作信息
  * 数仓的信息
  * 操作，抽取记录
  * 模型&仓库间的关系
* 操作方式
  * 保证重要操作有记录（日志&文档）
  * 便于查阅，检索，管理

## 快照概念

* 快照包含
  * 一系列的描述
  * 具体的有用的数据

# 优化

## 分层

* ods
  * 尽可能包保持和原来数据一样
* dw层
  * 轻度的数据汇总，通过一些方法进行汇总
    * 可累计的值，pv
    * 不可累计的值，uv
    * 由具体的需求设计出来具体的时间段划分
  * dwd
    * etl后的原始数据层，有统一的口径，理论上最小粒度的数据
  * dws
    * 按照具体的需求，天，月，任意时间段汇总
* ads
  * 面向用户端
  * 固化的展示或者通过交互的方式进行查询

## 数据质量控制

* 事前探查
  * 格式问题，口径问题，是否由系统的bug产生的脏数据
* 事中监控
  * 资源调度，任务链的执行情况
* 事后核对