<!DOCTYPE HTML>
<html lang="en">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="常用linux命令, Hexo">
    <meta name="description" content="Linux（vi/vim）一般模式


语法
功能描述



yy
复制光标当前一行


y数字y
复制一段（从第几行到第几行）


p
箭头移动到目的行粘贴


u
撤销上一步


dd
删除光标当前行


d数字d
删除光标（含）后多少">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>常用linux命令 | Hexo</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"></head>




<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Hexo</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>Categories</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>About</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/contact" class="waves-effect waves-light">
      
      <i class="fas fa-comments" style="zoom: 0.6;"></i>
      
      <span>Contact</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>Friends</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Hexo</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			Categories
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			About
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/contact" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-comments"></i>
			
			Contact
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			Friends
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/blinkfox/hexo-theme-matery" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/blinkfox/hexo-theme-matery" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/13.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">常用linux命令</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/linux/">
                                <span class="chip bg-color">linux</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/%E8%BF%90%E7%BB%B4-linux/" class="post-category">
                                运维 linux
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2022-01-19
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="Linux（vi-vim）"><a href="#Linux（vi-vim）" class="headerlink" title="Linux（vi/vim）"></a>Linux（vi/vim）</h2><h3 id="一般模式"><a href="#一般模式" class="headerlink" title="一般模式"></a>一般模式</h3><table>
<thead>
<tr>
<th>语法</th>
<th>功能描述</th>
</tr>
</thead>
<tbody><tr>
<td>yy</td>
<td>复制光标当前一行</td>
</tr>
<tr>
<td>y数字y</td>
<td>复制一段（从第几行到第几行）</td>
</tr>
<tr>
<td>p</td>
<td>箭头移动到目的行粘贴</td>
</tr>
<tr>
<td>u</td>
<td>撤销上一步</td>
</tr>
<tr>
<td>dd</td>
<td>删除光标当前行</td>
</tr>
<tr>
<td>d数字d</td>
<td>删除光标（含）后多少行</td>
</tr>
<tr>
<td>x</td>
<td>删除一个字母，相当于del</td>
</tr>
<tr>
<td>X</td>
<td>删除一个字母，相当于Backspace</td>
</tr>
<tr>
<td>yw</td>
<td>复制一个词</td>
</tr>
<tr>
<td>dw</td>
<td>删除一个词</td>
</tr>
<tr>
<td>shift+^</td>
<td>移动到行头</td>
</tr>
<tr>
<td>shift+$</td>
<td>移动到行尾</td>
</tr>
<tr>
<td>1+shift+g</td>
<td>移动到页头，数字</td>
</tr>
<tr>
<td>shift+g</td>
<td>移动到页尾</td>
</tr>
<tr>
<td>数字N+shift+g</td>
<td>移动到目标行</td>
</tr>
</tbody></table>
<h3 id="编辑模式"><a href="#编辑模式" class="headerlink" title="编辑模式"></a>编辑模式</h3><table>
<thead>
<tr>
<th>按键</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>i</td>
<td>当前光标前</td>
</tr>
<tr>
<td>a</td>
<td>当前光标后</td>
</tr>
<tr>
<td>o</td>
<td>当前光标行的下一行</td>
</tr>
<tr>
<td>I</td>
<td>光标所在行最前</td>
</tr>
<tr>
<td>A</td>
<td>光标所在行最后</td>
</tr>
<tr>
<td>O</td>
<td>当前光标行的上一行</td>
</tr>
</tbody></table>
<h3 id="指令模式"><a href="#指令模式" class="headerlink" title="指令模式"></a>指令模式</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>:w</td>
<td>保存</td>
</tr>
<tr>
<td>:q</td>
<td>退出</td>
</tr>
<tr>
<td>:!</td>
<td>强制执行</td>
</tr>
<tr>
<td>/要查找的词</td>
<td>n 查找下一个，N 往上查找</td>
</tr>
<tr>
<td>? 要查找的词</td>
<td>n是查找上一个，shift+n是往下查找</td>
</tr>
<tr>
<td>:set nu</td>
<td>显示行号</td>
</tr>
<tr>
<td>:set nonu</td>
<td>关闭行号</td>
</tr>
</tbody></table>
<h3 id="压缩和解压"><a href="#压缩和解压" class="headerlink" title="压缩和解压"></a>压缩和解压</h3><h4 id="gzip-gunzip-压缩"><a href="#gzip-gunzip-压缩" class="headerlink" title="gzip/gunzip 压缩"></a>gzip/gunzip 压缩</h4><p>（1）只能压缩文件不能压缩目录</p>
<p>（2）不保留原来的文件</p>
<p>gzip压缩：gzip hello.txt</p>
<p>gunzip解压缩文件：gunzip hello.txt.gz</p>
<h4 id="zip-unzip-压缩"><a href="#zip-unzip-压缩" class="headerlink" title="zip/unzip 压缩"></a>zip/unzip 压缩</h4><p>可以压缩目录且保留源文件</p>
<p>zip压缩（压缩 1.txt 和2.txt，压缩后的名称为mypackage.zip）：zip hello.zip hello.txt world.txt</p>
<p>unzip解压：unzip hello.zip</p>
<p>unzip解压到指定目录：unzip hello.zip -d /opt</p>
<h4 id="tar-打包"><a href="#tar-打包" class="headerlink" title="tar 打包"></a>tar 打包</h4><p>tar压缩多个文件：tar -zcvf hello.txt world.txt</p>
<p>tar压缩目录：tar -zcvf hello.tar.gz opt/</p>
<p>tar解压到当前目录：tar -zxvf hello.tar.gz</p>
<p>tar解压到指定目录：tar -zxvf hello.tar.gz -C /opt</p>
<h3 id="RPM"><a href="#RPM" class="headerlink" title="RPM"></a>RPM</h3><p>RPM查询命令：rpm -qa |grep firefox</p>
<p>RPM卸载命令：</p>
<p>rpm -e xxxxxx</p>
<p>rpm -e –nodeps xxxxxx（不检查依赖）</p>
<p>RPM安装命令：</p>
<p>rpm -ivh xxxxxx.rpm</p>
<p>rpm -ivh –nodeps fxxxxxx.rpm（–nodeps，不检测依赖进度）</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-i</td>
<td>-i=install，安装</td>
</tr>
<tr>
<td>-v</td>
<td>-v=verbose，显示详细信息</td>
</tr>
<tr>
<td>-h</td>
<td>-h=hash，进度条</td>
</tr>
<tr>
<td>–nodeps</td>
<td>–nodeps，不检测依赖进度</td>
</tr>
</tbody></table>
<hr>
<h2 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h2><h3 id="输入-输出重定向"><a href="#输入-输出重定向" class="headerlink" title="输入/输出重定向"></a>输入/输出重定向</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>command &gt; file</td>
<td>将输出重定向到 file</td>
</tr>
<tr>
<td>command &lt; file</td>
<td>将输入重定向到 file</td>
</tr>
<tr>
<td>command &gt;&gt; file</td>
<td>将输出以追加的方式重定向到 file</td>
</tr>
<tr>
<td>n &gt; file</td>
<td>将文件描述符为 n 的文件重定向到 file</td>
</tr>
<tr>
<td>n &gt;&gt; file</td>
<td>将文件描述符为 n 的文件以追加的方式重定向到 file</td>
</tr>
<tr>
<td>n &gt;&amp; m</td>
<td>将输出文件 m 和 n 合并</td>
</tr>
<tr>
<td>n &lt;&amp; m</td>
<td>将输入文件 m 和 n 合并</td>
</tr>
<tr>
<td>&lt;&lt; tag</td>
<td>将开始标记 tag 和结束标记 tag 之间的内容作为输入</td>
</tr>
</tbody></table>
<h3 id="脚本编辑"><a href="#脚本编辑" class="headerlink" title="脚本编辑"></a>脚本编辑</h3><table>
<thead>
<tr>
<th>快捷方式</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>shift</td>
<td>参数左移</td>
</tr>
<tr>
<td>$@</td>
<td>所有的参数</td>
</tr>
<tr>
<td>$#</td>
<td>参数的个数</td>
</tr>
</tbody></table>
<hr>
<h2 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h2><h3 id="启动类命令"><a href="#启动类命令" class="headerlink" title="启动类命令"></a>启动类命令</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>命令脚本</th>
</tr>
</thead>
<tbody><tr>
<td>启动hdfs集群</td>
<td>sbin/start-dfs.sh</td>
</tr>
<tr>
<td>启动yarn</td>
<td>sbin/start-yarn.sh</td>
</tr>
</tbody></table>
<h3 id="hadoop-fs-hdfs-dfs-命令"><a href="#hadoop-fs-hdfs-dfs-命令" class="headerlink" title="hadoop fs/hdfs dfs 命令"></a>hadoop fs/hdfs dfs 命令</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>创建目录</td>
<td>hdfs dfs -mkdir -p /data/flink</td>
</tr>
<tr>
<td>显示目录</td>
<td>hdfs dfs -ls /</td>
</tr>
<tr>
<td>从HDFS拷贝到本地</td>
<td>hdfs dfs -copyToLocal /data/data.txt ./</td>
</tr>
<tr>
<td>文件上传到集群(从本地)</td>
<td>hhdfs dfs -copyFromLocal data.txt /</td>
</tr>
<tr>
<td>文件下载</td>
<td>hdfs dfs -get /data/flink</td>
</tr>
<tr>
<td>删除集群的文件</td>
<td>hdfs dfs -rm /data/flink</td>
</tr>
<tr>
<td>删除文件夹</td>
<td>hdfs dfs -rm -r -skipTrash /data</td>
</tr>
<tr>
<td>从本地剪切粘贴到HDFS</td>
<td>hdfs dfs  -moveFromLocal data.txt /data/</td>
</tr>
<tr>
<td>追加一个文件到已经存在的文件末尾hdfs dfs -appendToFile data1.txt /data/data.txt</td>
<td></td>
</tr>
<tr>
<td>显示文件内容</td>
<td>hdfs dfs -cat data.txt</td>
</tr>
<tr>
<td>修改文件所属权限</td>
<td>hdfs dfs  -chmod  777 xxx.sh</td>
</tr>
<tr>
<td>修改文件所属用户组</td>
<td>hdfs dfs  -chown  root:root data.txt</td>
</tr>
<tr>
<td>从HDFS的一个路径拷贝到HDFS的另一个路径</td>
<td>hdfs dfs -cp data.txt /data1.txt</td>
</tr>
<tr>
<td>在HDFS目录中移动文件</td>
<td>hdfs dfs -mv data.txt /opt/</td>
</tr>
<tr>
<td>合并下载多个文件</td>
<td>hdfs dfs  -getmerge /data/* ./data_merge.txt</td>
</tr>
<tr>
<td>hadoop fs -put</td>
<td>等同于copyFromLocal</td>
</tr>
<tr>
<td>显示一个文件的末尾</td>
<td>hdfs dfs -tail data.txt</td>
</tr>
<tr>
<td>删除文件或文件夹</td>
<td>hdfs dfs -rm /data/data.txt</td>
</tr>
<tr>
<td>删除空目录</td>
<td>hdfs dfs -rmdir /data</td>
</tr>
<tr>
<td>统计文件夹的大小信息</td>
<td>hdfs dfs -s -h /data</td>
</tr>
<tr>
<td>统计文件夹下的文件大小信息</td>
<td>hdfs dfs  -h /data</td>
</tr>
<tr>
<td>设置HDFS中文件的副本数量</td>
<td>hdfs dfs -setrep 3 /data/data.txt</td>
</tr>
</tbody></table>
<h3 id="yarn命令"><a href="#yarn命令" class="headerlink" title="yarn命令"></a>yarn命令</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>查看正在运行的yarn任务列表</td>
<td>yarn application -list appID</td>
</tr>
<tr>
<td>kill掉指定id的yarn任务</td>
<td>yarn application -kill appID</td>
</tr>
<tr>
<td>查看任务日志信息</td>
<td>yarn logs -applicationId appID</td>
</tr>
</tbody></table>
<hr>
<h2 id="Zookeeper"><a href="#Zookeeper" class="headerlink" title="Zookeeper"></a>Zookeeper</h2><h3 id="启动命令"><a href="#启动命令" class="headerlink" title="启动命令"></a>启动命令</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>命令脚本</th>
</tr>
</thead>
<tbody><tr>
<td>启动zookeeper服务</td>
<td>zkServer.sh start</td>
</tr>
<tr>
<td>查看zookeeper状态</td>
<td>zkServer.sh status</td>
</tr>
<tr>
<td>停止zookeeper服务</td>
<td>zkServer.sh stop</td>
</tr>
<tr>
<td>启动zookeeper客户端</td>
<td>zkCli.sh -server 127.0.0.1:2181</td>
</tr>
<tr>
<td>退出zookeeper客户端</td>
<td>quit</td>
</tr>
</tbody></table>
<h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>命令脚本</th>
</tr>
</thead>
<tbody><tr>
<td>当前znode中所包含的内容</td>
<td>ls /</td>
</tr>
<tr>
<td>创建普通节点(前面是节点的路径，后面是值）</td>
<td>create /bigdata/flink “flink”</td>
</tr>
<tr>
<td>获取节点的值</td>
<td>get /bigdata</td>
</tr>
<tr>
<td>修改节点的值</td>
<td>set /bigdata/flink “flinksql”</td>
</tr>
<tr>
<td>删除节点</td>
<td>delete /bigdata/flink</td>
</tr>
<tr>
<td>递归删除节点</td>
<td>rmr /bigdata</td>
</tr>
</tbody></table>
<h3 id="四字母命令"><a href="#四字母命令" class="headerlink" title="四字母命令"></a>四字母命令</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
<th>例子</th>
</tr>
</thead>
<tbody><tr>
<td>conf</td>
<td>zk服务配置的详细信息</td>
<td>echo conf | nc 127.0.0.1 2181</td>
</tr>
<tr>
<td>stat</td>
<td>客户端与zk连接的简要信息</td>
<td>参考上面</td>
</tr>
<tr>
<td>srvr</td>
<td>zk服务的详细信息</td>
<td>参考上面</td>
</tr>
<tr>
<td>cons</td>
<td>客户端与zk连接的详细信息</td>
<td>参考上面</td>
</tr>
<tr>
<td>mntr</td>
<td>zk服务目前的性能状况</td>
<td>参考上面</td>
</tr>
<tr>
<td>crst</td>
<td>重置当前的所有连接、会话</td>
<td>参考上面</td>
</tr>
<tr>
<td>dump</td>
<td>列出未经处理的会话和连接信息</td>
<td>参考上面</td>
</tr>
<tr>
<td>envi</td>
<td>列出zk的版本信息、主机名称、Java版本、服务器名称等等</td>
<td>参考上面</td>
</tr>
<tr>
<td>ruok</td>
<td>测试服务器是否正在运行，如果在运行返回imok，否则返回空</td>
<td>参考上面</td>
</tr>
<tr>
<td>srst</td>
<td>重置Zookeeper的所有统计信息</td>
<td>参考上面</td>
</tr>
<tr>
<td>wchs</td>
<td>列出watch的总数，连接数</td>
<td>参考上面</td>
</tr>
<tr>
<td>wchp</td>
<td>列出所有watch的路径及sessionID</td>
<td>参考上面</td>
</tr>
<tr>
<td>mntr</td>
<td>列出集群的关键性能数据，包括zk的版本、node数量、临时节点数等等</td>
<td>参考上面</td>
</tr>
</tbody></table>
<hr>
<h2 id="Kafka"><a href="#Kafka" class="headerlink" title="Kafka"></a>Kafka</h2><p><strong>注:</strong> 这里机器我只写一个。命令你们也可使用 ./bin/xx.sh (如：./bin/kafka-topics.sh) </p>
<h3 id="查看当前服务器中的所有topic"><a href="#查看当前服务器中的所有topic" class="headerlink" title="查看当前服务器中的所有topic"></a>查看当前服务器中的所有topic</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-topics --zookeeper xxxxxx:2181 --list --exclude-internal 

说明：

exclude-internal：排除kafka内部topic

比如： --exclude-internal  --topic <span class="token string">"test_.*"</span></code></pre>
<h3 id="创建topic"><a href="#创建topic" class="headerlink" title="创建topic"></a>创建topic</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-topics --zookeeper xxxxxx:2181  --create 
--replication-factor 
--partitions <span class="token number">1</span> 
--topic topic_name

说明：

--topic 定义topic名

--replication-factor  定义副本数

--partitions  定义分区数</code></pre>

<h3 id="删除topic"><a href="#删除topic" class="headerlink" title="删除topic"></a>删除topic</h3><p><strong>注意:</strong> 需要server.properties中设置delete.topic.enable=true否则只是标记删除</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-topics --zookeeper xxxxxx:2181 --delete --topic topic_name</code></pre>

<h3 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-console-producer --broker-list xxxxxx:9092 --topic topic_name

可加：--property parse.key<span class="token operator">=</span>true（有key消息）</code></pre>
<h3 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-console-consumer --bootstrap-server xxxxxx:9092 --topic topic_name

注：可选

--from-beginning：会把主题中以往所有的数据都读取出来

--whitelist <span class="token string">'.*'</span> ：消费所有的topic

--property print.key<span class="token operator">=</span>true：显示key进行消费

--partition <span class="token number">0</span>：指定分区消费

--offset：指定起始偏移量消费</code></pre>

<h3 id="查看某个Topic的详情"><a href="#查看某个Topic的详情" class="headerlink" title="查看某个Topic的详情"></a>查看某个Topic的详情</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-topics --zookeeper xxxxxx:2181 --describe --topic topic_name</code></pre>

<h3 id="修改分区数"><a href="#修改分区数" class="headerlink" title="修改分区数"></a>修改分区数</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-topics --zookeeper xxxxxx:2181 --alter --topic topic_name --partitions <span class="token number">6</span></code></pre>

<h3 id="查看某个消费者组信息"><a href="#查看某个消费者组信息" class="headerlink" title="查看某个消费者组信息"></a>查看某个消费者组信息</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-consumer-groups --bootstrap-server  xxxxxx:9092  --describe --group group_name </code></pre>
<h3 id="删除消费者组"><a href="#删除消费者组" class="headerlink" title="删除消费者组"></a>删除消费者组</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-consumer-groups --bootstrap-server  xxxxxx:9092  ---delete --group group_name </code></pre>

<h3 id="重置offset"><a href="#重置offset" class="headerlink" title="重置offset"></a>重置offset</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-consumer-groups --bootstrap-server  xxxxxx:9092  --group group_name

--reset-offsets --all-topics --to-latest --execute </code></pre>

<h3 id="leader重新选举"><a href="#leader重新选举" class="headerlink" title="leader重新选举"></a>leader重新选举</h3><p>指定Topic指定分区用重新PREFERRED：优先副本策略 进行Leader重选举</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-leader-election --bootstrap-server xxxxxx:9092 
--topic topic_name --election-type PREFERRED --partition <span class="token number">0</span></code></pre>

<p>所有Topic所有分区用重新PREFERRED：优先副本策略 进行Leader重选举</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-leader-election --bootstrap-server xxxxxx:9092 
--election-type preferred  --all-topic-partitions</code></pre>

<h3 id="查询kafka版本信息"><a href="#查询kafka版本信息" class="headerlink" title="查询kafka版本信息"></a>查询kafka版本信息</h3><pre class="language-shell" data-language="shell"><code class="language-shell">kafka-configs --bootstrap-server xxxxxx:9092
--describe --version</code></pre>
<h3 id="增删改配置"><a href="#增删改配置" class="headerlink" title="增删改配置"></a>增删改配置</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>参数</th>
</tr>
</thead>
<tbody><tr>
<td>选择类型</td>
<td>–entity-type (topics/clients/users/brokers/broker- loggers)</td>
</tr>
<tr>
<td>类型名称</td>
<td>–entity-name</td>
</tr>
<tr>
<td>删除配置</td>
<td>–delete-config k1=v1,k2=v2</td>
</tr>
<tr>
<td>添加/修改配置</td>
<td>–add-config k1,k2</td>
</tr>
</tbody></table>
<p>topic添加/修改动态配置</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-configs --bootstrap-server xxxxxx:9092
--alter --entity-type topics --entity-name topic_name 
--add-config file.delete.delay.ms<span class="token operator">=</span><span class="token number">222222</span>,retention.ms<span class="token operator">=</span><span class="token number">999999</span></code></pre>

<p>topic删除动态配置</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-configs --bootstrap-server xxxxxx:9092 
--alter --entity-type topics --entity-name topic_name 
--delete-config file.delete.delay.ms,retention.ms</code></pre>

<h3 id="持续批量拉取消息"><a href="#持续批量拉取消息" class="headerlink" title="持续批量拉取消息"></a>持续批量拉取消息</h3><p>单次最大消费10条消息(不加参数意为持续消费)</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-verifiable-consumer --bootstrap-server xxxxxx:9092 
--group group_name
--topic topic_name --max-messages <span class="token number">10</span></code></pre>

<h3 id="删除指定分区的消息"><a href="#删除指定分区的消息" class="headerlink" title="删除指定分区的消息"></a>删除指定分区的消息</h3><p>删除指定topic的某个分区的消息删除至offset为1024</p>
<p>json文件offset-json-file.json</p>
<pre class="language-none"><code class="language-none">&#123;
    &quot;partitions&quot;: [
        &#123;
            &quot;topic&quot;: &quot;topic_name&quot;,
            &quot;partition&quot;: 0,
            &quot;offset&quot;: 1024
        &#125;
    ],
    &quot;version&quot;: 1
&#125;</code></pre>

<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-delete-records --bootstrap-server xxxxxx:9092 
--offset-json-file offset-json-file.json</code></pre>

<h3 id="查看Broker磁盘信息"><a href="#查看Broker磁盘信息" class="headerlink" title="查看Broker磁盘信息"></a>查看Broker磁盘信息</h3><p>查询指定topic磁盘信息</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-log-dirs --bootstrap-server xxxxxx:9090 
--describe --topic-list topic1,topic2</code></pre>

<p>查询指定Broker磁盘信息</p>
<pre class="language-shell" data-language="shell"><code class="language-shell">kafka-log-dirs --bootstrap-server xxxxxx:9090 
--describe --topic-list topic1 --broker-list <span class="token number">0</span></code></pre>

<h2 id="Hive"><a href="#Hive" class="headerlink" title="Hive"></a>Hive</h2><h3 id="启动类"><a href="#启动类" class="headerlink" title="启动类"></a>启动类</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>启动hiveserver2服务</td>
<td>bin/hiveserver2</td>
</tr>
<tr>
<td>启动beeline</td>
<td>bin/beeline</td>
</tr>
<tr>
<td>连接hiveserver2</td>
<td>beeline&gt; !connect jdbc:hive2://hadoop102:10000</td>
</tr>
<tr>
<td>metastroe服务</td>
<td>bin/hive –service metastore</td>
</tr>
</tbody></table>
<p>hive 启动元数据服务（metastore和hiveserver2）和优雅关闭脚本</p>
<pre class="language-none"><code class="language-none">启动： hive.sh start
关闭： hive.sh stop
重启： hive.sh restart
状态： hive.sh status</code></pre>
<p>脚本如下</p>
<pre class="language-none"><code class="language-none">#!&#x2F;bin&#x2F;bash
HIVE_LOG_DIR&#x3D;$HIVE_HOME&#x2F;logs

mkdir -p $HIVE_LOG_DIR

#检查进程是否运行正常，参数1为进程名，参数2为进程端口
function check_process()
&#123;
    pid&#x3D;$(ps -ef 2&gt;&#x2F;dev&#x2F;null | grep -v grep | grep -i $1 | awk &#39;&#123;print $2&#125;&#39;)
    ppid&#x3D;$(netstat -nltp 2&gt;&#x2F;dev&#x2F;null | grep $2 | awk &#39;&#123;print $7&#125;&#39; | cut -d &#39;&#x2F;&#39; -f 1)
    echo $pid
    [[ &quot;$pid&quot; &#x3D;~ &quot;$ppid&quot; ]] &amp;&amp; [ &quot;$ppid&quot; ] &amp;&amp; return 0 || return 1
&#125;

function hive_start()
&#123;
    metapid&#x3D;$(check_process HiveMetastore 9083)
    cmd&#x3D;&quot;nohup hive --service metastore &gt;$HIVE_LOG_DIR&#x2F;metastore.log 2&gt;&amp;1 &amp;&quot;
    cmd&#x3D;$cmd&quot; sleep4; hdfs dfsadmin -safemode wait &gt;&#x2F;dev&#x2F;null 2&gt;&amp;1&quot;
    [ -z &quot;$metapid&quot; ] &amp;&amp; eval $cmd || echo &quot;Metastroe服务已启动&quot;
    server2pid&#x3D;$(check_process HiveServer2 10000)
    cmd&#x3D;&quot;nohup hive --service hiveserver2 &gt;$HIVE_LOG_DIR&#x2F;hiveServer2.log 2&gt;&amp;1 &amp;&quot;
    [ -z &quot;$server2pid&quot; ] &amp;&amp; eval $cmd || echo &quot;HiveServer2服务已启动&quot;
&#125;

function hive_stop()
&#123;
    metapid&#x3D;$(check_process HiveMetastore 9083)
    [ &quot;$metapid&quot; ] &amp;&amp; kill $metapid || echo &quot;Metastore服务未启动&quot;
    server2pid&#x3D;$(check_process HiveServer2 10000)
    [ &quot;$server2pid&quot; ] &amp;&amp; kill $server2pid || echo &quot;HiveServer2服务未启动&quot;
&#125;

case $1 in
&quot;start&quot;)
    hive_start
    ;;
&quot;stop&quot;)
    hive_stop
    ;;
&quot;restart&quot;)
    hive_stop
    sleep 2
    hive_start
    ;;
&quot;status&quot;)
    check_process HiveMetastore 9083 &gt;&#x2F;dev&#x2F;null &amp;&amp; echo &quot;Metastore服务运行正常&quot; || echo &quot;Metastore服务运行异常&quot;
    check_process HiveServer2 10000 &gt;&#x2F;dev&#x2F;null &amp;&amp; echo &quot;HiveServer2服务运行正常&quot; || echo &quot;HiveServer2服务运行异常&quot;
    ;;
*)
    echo Invalid Args!
    echo &#39;Usage: &#39;$(basename $0)&#39; start|stop|restart|status&#39;
    ;;
esac</code></pre>

<h3 id="常用交互命令"><a href="#常用交互命令" class="headerlink" title="常用交互命令"></a>常用交互命令</h3><table>
<thead>
<tr>
<th>功能说明</th>
<th>命令</th>
</tr>
</thead>
<tbody><tr>
<td>不进入hive的交互窗口执行sql</td>
<td>bin/hive -e “sql语句”</td>
</tr>
<tr>
<td>执行脚本中sql语句</td>
<td>bin/hive -f hive.sql</td>
</tr>
<tr>
<td>退出hive窗口</td>
<td>exit 或 quit</td>
</tr>
<tr>
<td>命令窗口中查看hdfs文件系统</td>
<td>dfs -ls /</td>
</tr>
<tr>
<td>命令窗口中查看hdfs文件系统</td>
<td>! ls /data/h</td>
</tr>
</tbody></table>
<h3 id="SQL类-特殊的"><a href="#SQL类-特殊的" class="headerlink" title="SQL类(特殊的)"></a>SQL类(特殊的)</h3><table>
<thead>
<tr>
<th>说明</th>
<th>语句</th>
</tr>
</thead>
<tbody><tr>
<td>查看hive中的所有数据库</td>
<td>show databases</td>
</tr>
<tr>
<td>用default数据库</td>
<td>use default</td>
</tr>
<tr>
<td>查询表结构</td>
<td>desc table_name</td>
</tr>
<tr>
<td>查看数据库</td>
<td>show databases</td>
</tr>
<tr>
<td>重命名表名</td>
<td>alter table table1 rename to table2</td>
</tr>
<tr>
<td>修改表中字段</td>
<td>alter table table_name change name user_name String</td>
</tr>
<tr>
<td>修改字段类型</td>
<td>alter table table_name change salary salary Double</td>
</tr>
<tr>
<td>创建外部表</td>
<td>create external table ….</td>
</tr>
<tr>
<td>查询外部表信息</td>
<td>desc formatted outsidetable</td>
</tr>
<tr>
<td>创建视图</td>
<td>create view view_name as select * from table_name …..</td>
</tr>
<tr>
<td>添加数据</td>
<td>load data local inpath ‘xxx’  overwrite into table table_name partition(day=’2021-12-01’)</td>
</tr>
</tbody></table>
<h3 id="内置函数"><a href="#内置函数" class="headerlink" title="内置函数"></a>内置函数</h3><p>（1） NVL</p>
<p>给值为NULL的数据赋值，它的格式是NVL( value，default_value)。它的功能是如果value为NULL，则NVL函数返回default_value的值，否则返回value的值，如果两个参数都为NULL ，则返回NULL</p>
<pre class="language-none"><code class="language-none">select nvl(column, 0) from xxx；</code></pre>

<p>（2）行转列</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>CONCAT(string A/col, string B/col…)</td>
<td>返回输入字符串连接后的结果，支持任意个输入字符串</td>
</tr>
<tr>
<td>CONCAT_WS(separator, str1, str2,…)</td>
<td>第一个参数参数间的分隔符，如果分隔符是 NULL，返回值也将为 NULL。这个函数会跳过分隔符参数后的任何 NULL 和空字符串。分隔符将被加到被连接的字符串之间。</td>
</tr>
<tr>
<td>COLLECT_SET(col)</td>
<td>将某字段的值进行去重汇总，产生array类型字段</td>
</tr>
<tr>
<td>COLLECT_LIST(col)</td>
<td>函数只接受基本数据类型，它的主要作用是将某字段的值进行不去重汇总，产生array类型字段。</td>
</tr>
</tbody></table>
<p>（3）列转行(一列转多行)</p>
<p><strong>Split(str, separator)：</strong> 将字符串按照后面的分隔符切割，转换成字符array。</p>
<p><strong>EXPLODE(col)：</strong><br>将hive一列中复杂的array或者map结构拆分成多行。</p>
<p><strong>LATERAL VIEW</strong></p>
<pre class="language-none"><code class="language-none">用法：

LATERAL VIEW udtf(expression) tableAlias AS columnAlias</code></pre>
<p>解释：lateral view用于和split, explode等UDTF一起使用，它能够将一行数据拆成多行数据，在此基础上可以对拆分后的数据进行聚合。</p>
<p>lateral view首先为原始表的每行调用UDTF，UDTF会把一行拆分成一或者多行，lateral view再把结果组合，产生一个支持别名表的虚拟表。</p>
<p><strong>准备数据源测试</strong></p>
<table>
<thead>
<tr>
<th>movie</th>
<th>category</th>
</tr>
</thead>
<tbody><tr>
<td>《功勋》</td>
<td>记录,剧情</td>
</tr>
<tr>
<td>《战狼2》</td>
<td>战争,动作,灾难</td>
</tr>
</tbody></table>
<p><strong>SQL</strong></p>
<pre class="language-none"><code class="language-none">SELECT movie,category_name 
FROM movie_info 
lateral VIEW
explode(split(category,&quot;,&quot;)) movie_info_tmp  AS category_name ;
</code></pre>

<p><strong>测试结果</strong></p>
<pre class="language-none"><code class="language-none">《功勋》      记录
《功勋》      剧情
《战狼2》     战争
《战狼2》     动作
《战狼2》     灾难
</code></pre>

<h3 id="窗口函数"><a href="#窗口函数" class="headerlink" title="窗口函数"></a>窗口函数</h3><p>（1）OVER()</p>
<p>定分析函数工作的数据窗口大小，这个数据窗口大小可能会随着行的变而变化。</p>
<p>（2）CURRENT ROW（当前行）</p>
<pre class="language-none"><code class="language-none">n PRECEDING：往前n行数据

n FOLLOWING：往后n行数据</code></pre>

<p>（3）UNBOUNDED（无边界）</p>
<pre class="language-none"><code class="language-none">UNBOUNDED PRECEDING 前无边界，表示从前面的起点

UNBOUNDED FOLLOWING后无边界，表示到后面的终点</code></pre>

<p><strong>SQL案例：由起点到当前行的聚合</strong></p>
<pre class="language-none"><code class="language-none">select 
    sum(money) over(partition by user_id order by pay_time rows between UNBOUNDED PRECEDING and current row) 
from or_order;</code></pre>

<p><strong>SQL案例：当前行和前面一行做聚合</strong></p>
<pre class="language-none"><code class="language-none">select 
    sum(money) over(partition by user_id order by pay_time rows between 1 PRECEDING and current row) 
from or_order;</code></pre>

<p><strong>SQL案例：当前行和前面一行和后一行做聚合</strong></p>
<pre class="language-none"><code class="language-none">select 
    sum(money) over(partition by user_id order by pay_time rows between 1 PRECEDING AND 1 FOLLOWING )
from or_order;</code></pre>

<p><strong>SQL案例：当前行及后面所有行</strong></p>
<pre class="language-none"><code class="language-none">select 
    sum(money) over(partition by user_id order by pay_time rows between current row and UNBOUNDED FOLLOWING  )
from or_order;</code></pre>

<p>（4）LAG(col,n,default_val)</p>
<p>往前第n行数据，没有的话default_val</p>
<p>（5）LEAD(col,n, default_val)</p>
<p>往后第n行数据，没有的话default_val</p>
<p><strong>SQL案例：查询用户购买明细以及上次的购买时间和下次购买时间</strong></p>
<pre class="language-none"><code class="language-none">select 
	user_id,,pay_time,money,
	
	lag(pay_time,1,&#39;1970-01-01&#39;) over(PARTITION by name order by pay_time) prev_time,
	
	lead(pay_time,1,&#39;1970-01-01&#39;) over(PARTITION by name order by pay_time) next_time
from or_order;
</code></pre>

<p>（6）FIRST_VALUE(col,true/false)</p>
<p>当前窗口下的第一个值，第二个参数为true，跳过空值。</p>
<p>（7）LAST_VALUE (col,true/false)</p>
<p>当前窗口下的最后一个值，第二个参数为true，跳过空值。</p>
<p><strong>SQL案例：查询用户每个月第一次的购买时间 和 每个月的最后一次购买时间</strong></p>
<pre class="language-none"><code class="language-none">select
	FIRST_VALUE(pay_time) 
	    over(
	        partition by user_id,month(pay_time) order by pay_time 
	        rows between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING
	        ) first_time,
	
	LAST_VALUE(pay_time) 
	    over(partition by user_id,month(pay_time) order by pay_time rows between UNBOUNDED PRECEDING and UNBOUNDED FOLLOWING
	    ) last_time
from or_order;
</code></pre>


<p>（8）NTILE(n)</p>
<p>把有序窗口的行分发到指定数据的组中，各个组有编号，编号从1开始，对于每一行，NTILE返回此行所属的组的编号。（用于将分组数据按照顺序切分成n片，返回当前切片值）</p>
<p><strong>SQL案例：查询前25%时间的订单信息</strong></p>
<pre class="language-none"><code class="language-none">select * from (
    select User_id,pay_time,money,
    
    ntile(4) over(order by pay_time) sorted
    
    from or_order
) t
where sorted &#x3D; 1;
</code></pre>

<h3 id="4个By"><a href="#4个By" class="headerlink" title="4个By"></a>4个By</h3><p>（1）Order By</p>
<p>全局排序，只有一个Reducer。</p>
<p>（2）Sort By</p>
<p>分区内有序。</p>
<p>（3）Distrbute By</p>
<p>类似MR中Partition，进行分区，结合sort by使用。</p>
<p>（4） Cluster By</p>
<p>当Distribute by和Sorts by字段相同时，可以使用Cluster by方式。Cluster by除了具有Distribute by的功能外还兼具Sort by的功能。但是排序只能是升序排序，不能指定排序规则为ASC或者DESC。</p>
<p>在生产环境中Order By用的比较少，容易导致OOM。</p>
<p>在生产环境中Sort By+ Distrbute By用的多。</p>
<h3 id="排序函数"><a href="#排序函数" class="headerlink" title="排序函数"></a>排序函数</h3><p>（1）RANK() </p>
<p>排序相同时会重复，总数不会变</p>
<pre class="language-none"><code class="language-none">1
1
3
3
5</code></pre>
<p>（2）DENSE_RANK() </p>
<p>排序相同时会重复，总数会减少</p>
<pre class="language-none"><code class="language-none">1
1
2
2
3</code></pre>
<p>（3）ROW_NUMBER()</p>
<p>会根据顺序计算</p>
<pre class="language-none"><code class="language-none">1
2
3
4
5</code></pre>

<h3 id="日期函数"><a href="#日期函数" class="headerlink" title="日期函数"></a>日期函数</h3><p>datediff：返回结束日期减去开始日期的天数</p>
<pre class="language-none"><code class="language-none">datediff(string enddate, string startdate) 

select datediff(&#39;2021-11-20&#39;,&#39;2021-11-22&#39;) </code></pre>

<p>date_add：返回开始日期startdate增加days天后的日期</p>
<pre class="language-none"><code class="language-none">date_add(string startdate, int days) 

select date_add(&#39;2021-11-20&#39;,3) </code></pre>
<p>date_sub：返回开始日期startdate减少days天后的日期</p>
<pre class="language-none"><code class="language-none">date_sub (string startdate, int days) 

select date_sub(&#39;2021-11-22&#39;,3)</code></pre>

<h2 id="Impala-时间处理，可类比到hive可用"><a href="#Impala-时间处理，可类比到hive可用" class="headerlink" title="Impala(时间处理，可类比到hive可用)"></a>Impala(时间处理，可类比到hive可用)</h2><h3 id="1-获取当前时间"><a href="#1-获取当前时间" class="headerlink" title="1. 获取当前时间"></a>1. 获取当前时间</h3><p>timestamp 样式2021-12-10 04:36:48.147046000</p>
<p>bigint 样式 1639110956</p>
<table>
<thead>
<tr>
<th>函数/方法</th>
<th>输出类型</th>
<th>说明/样式</th>
</tr>
</thead>
<tbody><tr>
<td>current_timestamp()</td>
<td>timestamp</td>
<td>所在时区的当前时间</td>
</tr>
<tr>
<td>now()</td>
<td>timestamp</td>
<td>所在时区的当前时间</td>
</tr>
<tr>
<td>unix_timestamp()</td>
<td>bigint</td>
<td>所在时区的当前时间戳</td>
</tr>
<tr>
<td>utc_timestamp</td>
<td>timestamp</td>
<td>UTC时区的当前时间</td>
</tr>
<tr>
<td>timeofday()</td>
<td>string</td>
<td>Fri Dec 10 12:39:46 2021 CST</td>
</tr>
</tbody></table>
<h3 id="2-获取时间指定单位函数"><a href="#2-获取时间指定单位函数" class="headerlink" title="2. 获取时间指定单位函数"></a>2. 获取时间指定单位函数</h3><table>
<thead>
<tr>
<th>序号</th>
<th>函数/方法</th>
<th>输出类型</th>
<th>说明/样式</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>year(timestamp/date)</td>
<td>int</td>
<td>获取年 yyyy</td>
</tr>
<tr>
<td>2</td>
<td>quarter(timestamp/date)</td>
<td>int</td>
<td>获取季节（1,2,3,4）</td>
</tr>
<tr>
<td>3</td>
<td>month(timestamp/date)</td>
<td>int</td>
<td>获取月</td>
</tr>
<tr>
<td>4</td>
<td>monthname(timestamp/date)</td>
<td>string</td>
<td>获取月份名称 December</td>
</tr>
<tr>
<td>5</td>
<td>week(timestamp/date)</td>
<td>int</td>
<td>获取周（1-53）</td>
</tr>
<tr>
<td>6</td>
<td>weekofyear(timestamp/date)</td>
<td>int</td>
<td>获取周（1-53）</td>
</tr>
<tr>
<td>7</td>
<td>dayofweek(timestamp/date)</td>
<td>int</td>
<td>获取天（本周第多少天,周日算第一天）</td>
</tr>
<tr>
<td>8</td>
<td>dayname(timestamp/date)</td>
<td>string</td>
<td>获取天（星期几）Friday</td>
</tr>
<tr>
<td>9</td>
<td>next_day(timestamp/date, 10</td>
<td>day(string))</td>
<td>timestamp/date</td>
</tr>
<tr>
<td>11</td>
<td>day(timestamp/date)</td>
<td>int</td>
<td>获取天（本月第多少天）</td>
</tr>
<tr>
<td>12</td>
<td>dayofmonth(timestamp/date)</td>
<td>int</td>
<td>获取天（本月第多少天）</td>
</tr>
<tr>
<td>13</td>
<td>last_day(timestamp/date)</td>
<td>timestamp/date</td>
<td>获取天（本月的最后一天日期）</td>
</tr>
<tr>
<td>14</td>
<td>dayofyear(timestamp/date)</td>
<td>int</td>
<td>获取天（本年第多少天）</td>
</tr>
<tr>
<td>15</td>
<td>hour(timestamp/date)</td>
<td>int</td>
<td>获取小时</td>
</tr>
<tr>
<td>16</td>
<td>minute(timestamp date)</td>
<td>int</td>
<td>获取分钟</td>
</tr>
<tr>
<td>17</td>
<td>second(timestamp date)</td>
<td>int</td>
<td>获取秒</td>
</tr>
<tr>
<td>18</td>
<td>millisecond(timestamp date)</td>
<td>int</td>
<td>获取毫秒</td>
</tr>
<tr>
<td>19</td>
<td>extract (YEAR FROM timestamp)</td>
<td>bigint</td>
<td>获取参数指定的时间单位 YEAR MONTH DAY  HOUR MINUTE SECOND</td>
</tr>
<tr>
<td>20</td>
<td>date_part(‘year’,timestamp)</td>
<td>bigint</td>
<td>获取参数指定的时间单位 YEAR MONTH DAY  HOUR MINUTE SECOND</td>
</tr>
<tr>
<td>21</td>
<td>trunc(timestamp/date,unit)</td>
<td>timestamp/date</td>
<td>获取截断为指定单位的时间</td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th>unit</th>
<th>截取说明</th>
</tr>
</thead>
<tbody><tr>
<td>SYYYY，YYYY，YEAR，SYEAR，YYY，YY，Y</td>
<td>年</td>
</tr>
<tr>
<td>Q</td>
<td>季节</td>
</tr>
<tr>
<td>MONTH，MON，MM，RM</td>
<td>月</td>
</tr>
<tr>
<td>WW</td>
<td>最近的日期是与一年中的第一天相同的日期</td>
</tr>
<tr>
<td>W</td>
<td>最近的日期是与该月的第一天相同的星期几</td>
</tr>
<tr>
<td>DDD，DD，J</td>
<td>天</td>
</tr>
<tr>
<td>DAY，DY，D</td>
<td>星期几（星期一）的开始</td>
</tr>
<tr>
<td>HH，HH12，HH24</td>
<td>小时</td>
</tr>
<tr>
<td>MI</td>
<td>分钟</td>
</tr>
</tbody></table>
<h3 id="3-时间比较函数"><a href="#3-时间比较函数" class="headerlink" title="3. 时间比较函数"></a>3. 时间比较函数</h3><table>
<thead>
<tr>
<th>序号</th>
<th>函数/方法</th>
<th>输出类型</th>
<th>说明/样式</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>datediff(timestamp enddate,startdate)</td>
<td>int</td>
<td>返回endDate比startDate多多少天</td>
</tr>
<tr>
<td>2</td>
<td>int_months_between(timestamp t1,t2)</td>
<td>int</td>
<td>返回两个日期相差的整数月份个数</td>
</tr>
<tr>
<td>3</td>
<td>months_between(timestamp t1,t2)</td>
<td>double</td>
<td>返回浮点数的月数相差的数</td>
</tr>
<tr>
<td>4</td>
<td>date_cmp(DATE date1, DATE date2)</td>
<td>int</td>
<td>比较是否相等，返回-1,0,1,null四种数值</td>
</tr>
<tr>
<td>5</td>
<td>timestamp_cmp(timestamp t1，timestamp t2)</td>
<td>int</td>
<td>比较是否相等，返回-1,0,1,null四种数值</td>
</tr>
</tbody></table>
<h3 id="4-时间格式转换函数"><a href="#4-时间格式转换函数" class="headerlink" title="4. 时间格式转换函数"></a>4. 时间格式转换函数</h3><table>
<thead>
<tr>
<th>序号</th>
<th>函数/方法</th>
<th>输出类型</th>
<th>说明/样式</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>to_date(timestamp date)</td>
<td>string</td>
<td>返回时间戳对应的date</td>
</tr>
<tr>
<td>2</td>
<td>to_timestamp(bigint unixtime)</td>
<td>timestamp</td>
<td>返回整数对应的timestamp值</td>
</tr>
<tr>
<td>3</td>
<td>to_timestamp(string date，string pattern)</td>
<td>timestamp</td>
<td>返回字符串对应的timestamp值</td>
</tr>
<tr>
<td>4</td>
<td>to_utc_timestamp(timestamp t，string timezone)</td>
<td>timestamp</td>
<td>指定时区的时间戳转化为UTC时区的时间戳</td>
</tr>
<tr>
<td>5</td>
<td>from_timestamp(timestamp t，string pattern)</td>
<td>string</td>
<td>把timestamp按照pattern进行格式化</td>
</tr>
<tr>
<td>6</td>
<td>from_timestamp(string date，string pattern)</td>
<td>string</td>
<td>把date按照pattern进行格式化</td>
</tr>
<tr>
<td>7</td>
<td>from_unixtime(bigint unixtime)</td>
<td>string</td>
<td>把时间戳秒数转化为本地地区中的字符串</td>
</tr>
<tr>
<td>8</td>
<td>from_unixtime(bigint unixtime，string pattern）</td>
<td>string</td>
<td>时间戳转化为本地时区字符串，pattern格式</td>
</tr>
<tr>
<td>9</td>
<td>from_utc_timestamp（timestamp t，string timezone）</td>
<td>timestamp</td>
<td>UTC时区指定时间戳转化为指定时区时间戳</td>
</tr>
<tr>
<td>10</td>
<td>unix_timestamp(string datetime)</td>
<td>bigint</td>
<td>把string类型的date或日期转化成时间戳Unix</td>
</tr>
<tr>
<td>11</td>
<td>unix_timestamp(timestamp datetime)</td>
<td>bigint</td>
<td>把string类型的timestamp转化成时间戳Unix</td>
</tr>
<tr>
<td>12</td>
<td>unix_timestamp(string datetime，string pattern)</td>
<td>bigint</td>
<td>日期按pattern转化成时间戳Unix</td>
</tr>
</tbody></table>
<h3 id="5-时间计算函数"><a href="#5-时间计算函数" class="headerlink" title="5. 时间计算函数"></a>5. 时间计算函数</h3><table>
<thead>
<tr>
<th>序号</th>
<th>函数/方法</th>
<th>输出类型</th>
<th>说明/样式</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>years_add(timestamp/date date, int/bigint years)</td>
<td>timestamp/date</td>
<td>增加指定年数</td>
</tr>
<tr>
<td>2</td>
<td>years_sub(timestamp/date date, int/bigint years)</td>
<td>timestamp/date</td>
<td>减少指定年数</td>
</tr>
<tr>
<td>3</td>
<td>months_add(timestamp/date date, int/bigint months)</td>
<td>timestamp/date</td>
<td>增加指定月数</td>
</tr>
<tr>
<td>4</td>
<td>months_sub(timestamp/date date, int/bigint months)</td>
<td>timestamp/date</td>
<td>减少指定月数</td>
</tr>
<tr>
<td>5</td>
<td>add_months(timestamp/date date, int/bigint months)</td>
<td>timestamp/date</td>
<td>增加指定月数</td>
</tr>
<tr>
<td>6</td>
<td>weeks_add(timestamp/date date, int/bigint weeks)</td>
<td>timestamp/date</td>
<td>增加指定周数</td>
</tr>
<tr>
<td>7</td>
<td>weeks_sub(timestamp/date date, int/bigint weeks)</td>
<td>timestamp/date</td>
<td>减少指定周数</td>
</tr>
<tr>
<td>8</td>
<td>days_add(timestamp/date startdate, int/bigint days)</td>
<td>timestamp/date</td>
<td>增加指定天数</td>
</tr>
<tr>
<td>9</td>
<td>days_sub(timestamp/date startdate, int/bigint days)</td>
<td>timestamp/date</td>
<td>减少指定天数</td>
</tr>
<tr>
<td>10</td>
<td>date_add(timestamp/date startdate, int/bigint days)</td>
<td>timestamp/date</td>
<td>增加指定天数</td>
</tr>
<tr>
<td>11</td>
<td>date_sub(timestamp/date startdate, int/bigint days)</td>
<td>timestamp/date</td>
<td>减少指定天数</td>
</tr>
<tr>
<td>12</td>
<td>adddate(timestamp/date startdate, int/int days)</td>
<td>timestamp/date</td>
<td>增加指定天数</td>
</tr>
<tr>
<td>13</td>
<td>subdate(timestamp/date startdate，bigint/int days)</td>
<td>timestamp/date</td>
<td>减少指定天数</td>
</tr>
<tr>
<td>14</td>
<td>hours_add(timestamp date, int/bigint hours)</td>
<td>timestamp</td>
<td>增加指定小时</td>
</tr>
<tr>
<td>15</td>
<td>hours_sub(timestamp date, int/bigint hours)</td>
<td>timestamp</td>
<td>减少指定小时</td>
</tr>
<tr>
<td>16</td>
<td>minutes_add(timestamp date, int/bigint minutes)</td>
<td>timestamp</td>
<td>增加指定分钟</td>
</tr>
<tr>
<td>17</td>
<td>minutes_sub(timestamp date, int/bigint minutes)</td>
<td>timestamp</td>
<td>减少指定分钟</td>
</tr>
<tr>
<td>18</td>
<td>seconds_add(timestamp date, int/bigint seconds)</td>
<td>timestamp</td>
<td>增加指定秒数</td>
</tr>
<tr>
<td>19</td>
<td>seconds_sub(timestamp date, int/bigint seconds)</td>
<td>timestamp</td>
<td>减少指定秒数</td>
</tr>
<tr>
<td>20</td>
<td>milliseconds_add(timestamp t, int/bigint s）</td>
<td>timestamp</td>
<td>增加指定毫秒数</td>
</tr>
<tr>
<td>21</td>
<td>milliseconds_sub(timestamp t, int/bigint s）</td>
<td>timestamp</td>
<td>减少指定毫秒数</td>
</tr>
<tr>
<td>22</td>
<td>microseconds_add(timestamp t, int/bigint s)</td>
<td>timestamp</td>
<td>增加指定微秒数</td>
</tr>
<tr>
<td>23</td>
<td>microseconds_sub(timestamp t, int/bigint s)</td>
<td>timestamp</td>
<td>减少指定微秒数</td>
</tr>
<tr>
<td>24</td>
<td>nanoseconds_add(timestamp t, int/bigint s）</td>
<td>timestamp</td>
<td>增加指定纳秒数</td>
</tr>
<tr>
<td>25</td>
<td>nanoseconds_sub(timestamp t, int/bigint s）</td>
<td>timestamp</td>
<td>减少指定纳秒数</td>
</tr>
<tr>
<td>26</td>
<td>date_add(timestamp/date startdate, interval_expression)</td>
<td>timestamp/date</td>
<td>使用参数计算日期增量值（增加）</td>
</tr>
<tr>
<td>27</td>
<td>date_sub(timestamp/date startdate, interval_expression)</td>
<td>timestamp/date</td>
<td>使用参数计算日期增量值（减少）</td>
</tr>
</tbody></table>
<hr>
<h2 id="Redis"><a href="#Redis" class="headerlink" title="Redis"></a>Redis</h2><h3 id="启动类-1"><a href="#启动类-1" class="headerlink" title="启动类"></a>启动类</h3><h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>keys  *</td>
<td>查看当前库的所有键</td>
</tr>
<tr>
<td>exists <key></td>
<td>判断某个键是否存在</td>
</tr>
<tr>
<td>type <key></td>
<td>查看键的类型</td>
</tr>
<tr>
<td>del <key></td>
<td>删除某个键</td>
</tr>
<tr>
<td>expire <key> <seconds></td>
<td>为键值设置过期时间，单位秒</td>
</tr>
<tr>
<td>ttl <key></td>
<td>查看还有多久过期,-1表示永不过期,-2表示已过期</td>
</tr>
<tr>
<td>dbsize</td>
<td>查看当前数据库中key的数量</td>
</tr>
<tr>
<td>flushdb</td>
<td>清空当前库</td>
</tr>
<tr>
<td>Flushall</td>
<td>通杀全部库</td>
</tr>
</tbody></table>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a>String</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>get <key></td>
<td>查询对应键值</td>
</tr>
<tr>
<td>set <key> <value></td>
<td>添加键值对</td>
</tr>
<tr>
<td>append <key> <value></td>
<td>将给定的<value>追加到原值的末尾</td>
</tr>
<tr>
<td>strlen <key></td>
<td>获取值的长度</td>
</tr>
<tr>
<td>setnx <key> <value></td>
<td>只有在key 不存在时设置key的值</td>
</tr>
<tr>
<td>incr <key></td>
<td>将key中存储的数字值增1只能对数字值操作，如果为空，新增值为1</td>
</tr>
<tr>
<td>decr <key></td>
<td>将key中存储的数字值减1只能对数字之操作，如果为空,新增值为-1</td>
</tr>
<tr>
<td>incrby /decrby <key> 步长</td>
<td>将key中存储的数字值增减，自定义步长</td>
</tr>
<tr>
<td>mset <key1> <value1> <key2> <value2></td>
<td>同时设置一个或多个key-value对</td>
</tr>
<tr>
<td>mget <key1> <key2>  <key3></td>
<td>同时获取一个或多个value</td>
</tr>
<tr>
<td>msetnx <key1> <value1> <key2> <value2></td>
<td>同时设置一个或多个key-value对，当且仅当所有给定的key都不存在</td>
</tr>
<tr>
<td>getrange <key> &lt;起始位置&gt; &lt;结束位置&gt;</td>
<td>获得值的范围,类似java中的substring</td>
</tr>
<tr>
<td>setrange <key> &lt;起始位置&gt; <value></td>
<td>用<value>覆盖<key>所存储的字符串值，从&lt;起始位置&gt;开始</td>
</tr>
<tr>
<td>setex <key> &lt;过期时间&gt; <value></td>
<td>设置键值的同时，设置过去时间，单位秒</td>
</tr>
<tr>
<td>getset <key> <value></td>
<td>以新换旧,设置了新值的同时获取旧值</td>
</tr>
</tbody></table>
<h3 id="List"><a href="#List" class="headerlink" title="List"></a>List</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>lpush/rpush  <key>  <value1>  <value2></td>
<td>从左边/右边插入一个或多个值。</td>
</tr>
<tr>
<td>lpop/rpop  <key></td>
<td>从左边/右边吐出一个值。值在键在，值光键亡。</td>
</tr>
<tr>
<td>rpoplpush  <key1>  <key2></td>
<td>从<key1>列表右边吐出一个值，插到<key2>列表左边</td>
</tr>
<tr>
<td>lrange <key> <start> <stop></td>
<td>按照索引下标获得元素(从左到右)</td>
</tr>
<tr>
<td>lindex <key> <index></td>
<td>按照索引下标获得元素(从左到右)</td>
</tr>
<tr>
<td>llen <key></td>
<td>获得列表长度</td>
</tr>
<tr>
<td>linsert <key>  before <value>  <newvalue></td>
<td>在<value>的后面插入<newvalue> 插入值</td>
</tr>
<tr>
<td>lrem <key> <n>  <value></td>
<td>从左边删除n个value(从左到右)</td>
</tr>
</tbody></table>
<h3 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>sadd <key>  <value1>  <value2> ….</td>
<td>将一个或多个 member 元素加入到集合 key 当中，已经存在于集合的 member 元素将被忽略。</td>
</tr>
<tr>
<td>smembers <key></td>
<td>取出该集合的所有值。</td>
</tr>
<tr>
<td>sismember <key>  <value></td>
<td>判断集合<key>是否为含有该<value>值，有返回1，没有返回0</td>
</tr>
<tr>
<td>scard  <key></td>
<td>返回该集合的元素个数。</td>
</tr>
<tr>
<td>srem <key> <value1> <value2> ….</td>
<td>删除集合中的某个元素。</td>
</tr>
<tr>
<td>spop <key></td>
<td>随机从该集合中吐出一个值。</td>
</tr>
<tr>
<td>srandmember <key> <n></td>
<td>随机从该集合中取出n个值。不会从集合中删除</td>
</tr>
<tr>
<td>sinter <key1> <key2></td>
<td>返回两个集合的交集元素。</td>
</tr>
<tr>
<td>sunion <key1> <key2></td>
<td>返回两个集合的并集元素。</td>
</tr>
<tr>
<td>sdiff <key1> <key2></td>
<td>返回两个集合的差集元素。</td>
</tr>
</tbody></table>
<h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>hset <key>  <field>  <value></td>
<td>给<key>集合中的  <field>键赋值<value></td>
</tr>
<tr>
<td>hget <key1>  <field></td>
<td>从<key1>集合<field> 取出 value</td>
</tr>
<tr>
<td>hmset <key1>  <field1> <value1> <field2> <value2>…</td>
<td>批量设置hash的值</td>
</tr>
<tr>
<td>hexists key  <field></td>
<td>查看哈希表 key 中，给定域 field 是否存在。</td>
</tr>
<tr>
<td>hkeys <key></td>
<td>列出该hash集合的所有field</td>
</tr>
<tr>
<td>hvals <key></td>
<td>列出该hash集合的所有value</td>
</tr>
<tr>
<td>hincrby <key> <field>  <increment></td>
<td>为哈希表 key 中的域 field 的值加上增量 increment</td>
</tr>
<tr>
<td>hsetnx <key>  <field> <value></td>
<td>将哈希表 key 中的域 field 的值设置为 value ，当且仅当域 field 不存在</td>
</tr>
</tbody></table>
<h3 id="zset-Sorted-set"><a href="#zset-Sorted-set" class="headerlink" title="zset(Sorted set)"></a>zset(Sorted set)</h3><table>
<thead>
<tr>
<th>命令</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>zadd  <key> <score1> <value1>  <score2> <value2>…</td>
<td>将一个或多个 member 元素及其 score 值加入到有序集 key 当中</td>
</tr>
<tr>
<td>zrange <key>  <start> <stop>  [WITHSCORES]</td>
<td>返回有序集 key 中，下标在<start> <stop>之间的元素带WITHSCORES，可以让分数一起和值返回到结果集。</td>
</tr>
<tr>
<td>zrangebyscore key min max [withscores] [limit offset count]</td>
<td>返回有序集 key 中，所有 score 值介于 min 和 max 之间(包括等于 min 或 max )的成员。有序集成员按 score 值递增(从小到大)次序排列。</td>
</tr>
<tr>
<td>zrevrangebyscore key max min [withscores] [limit offset count]</td>
<td>同上，改为从大到小排列。</td>
</tr>
<tr>
<td>zincrby <key> <increment> <value></td>
<td>为元素的score加上增量</td>
</tr>
<tr>
<td>zrem  <key>  <value></td>
<td>删除该集合下，指定值的元素</td>
</tr>
<tr>
<td>zcount <key>  <min>  <max></td>
<td>统计该集合，分数区间内的元素个数</td>
</tr>
<tr>
<td>zrank <key>  <value></td>
<td>返回该值在集合中的排名，从0开始。</td>
</tr>
</tbody></table>
<hr>
<h2 id="Flink"><a href="#Flink" class="headerlink" title="Flink"></a>Flink</h2><h3 id="启动"><a href="#启动" class="headerlink" title="启动"></a>启动</h3><pre class="language-none"><code class="language-none">.&#x2F;start-cluster.sh </code></pre>

<h3 id="run"><a href="#run" class="headerlink" title="run"></a>run</h3><pre class="language-none"><code class="language-none">.&#x2F;bin&#x2F;flink run [OPTIONS]

.&#x2F;bin&#x2F;flink run -m yarn-cluster -c com.wang.flink.WordCount &#x2F;opt&#x2F;app&#x2F;WordCount.jar</code></pre>

<table>
<thead>
<tr>
<th>OPTIONS</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>detached 是否使用分离模式</td>
</tr>
<tr>
<td>-m</td>
<td>jobmanager 指定提交的jobmanager</td>
</tr>
<tr>
<td>-yat</td>
<td>–yarnapplicationType 设置yarn应用的类型</td>
</tr>
<tr>
<td>-yD</td>
<td>使用给定属性的值</td>
</tr>
<tr>
<td>-yd</td>
<td>–yarndetached 使用yarn分离模式</td>
</tr>
<tr>
<td>-yh</td>
<td>–yarnhelp yarn session的帮助</td>
</tr>
<tr>
<td>-yid</td>
<td>–yarnapplicationId 挂到正在运行的yarnsession上</td>
</tr>
<tr>
<td>-yj</td>
<td>–yarnjar Flink jar文件的路径</td>
</tr>
<tr>
<td>-yjm</td>
<td>–yarnjobManagerMemory jobmanager的内存(单位M)</td>
</tr>
<tr>
<td>-ynl</td>
<td>–yarnnodeLabel 指定 YARN 应用程序 YARN 节点标签</td>
</tr>
<tr>
<td>-ynm</td>
<td>–yarnname 自定义yarn应用名称</td>
</tr>
<tr>
<td>-yq</td>
<td>–yarnquery 显示yarn的可用资源</td>
</tr>
<tr>
<td>-yqu</td>
<td>–yarnqueue 指定yarn队列</td>
</tr>
<tr>
<td>-ys</td>
<td>–yarnslots 指定每个taskmanager的slots数</td>
</tr>
<tr>
<td>-yt</td>
<td>yarnship 在指定目录中传输文件</td>
</tr>
<tr>
<td>-ytm</td>
<td>–yarntaskManagerMemory 每个taskmanager的内存</td>
</tr>
<tr>
<td>-yz</td>
<td>–yarnzookeeperNamespace 用来创建ha的zk子路径的命名空间</td>
</tr>
<tr>
<td>-z</td>
<td>–zookeeperNamespace 用来创建ha的zk子路径的命名空间</td>
</tr>
<tr>
<td>-p</td>
<td>并行度</td>
</tr>
<tr>
<td>-yn</td>
<td>需要分配的YARN容器个数(=任务管理器的数量)</td>
</tr>
</tbody></table>
<h3 id="info"><a href="#info" class="headerlink" title="info"></a>info</h3><pre class="language-none"><code class="language-none">.&#x2F;bin&#x2F;flink info [OPTIONS]</code></pre>
<table>
<thead>
<tr>
<th>OPTIONS</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>程序进入点，主类</td>
</tr>
<tr>
<td>-p</td>
<td>并行度</td>
</tr>
</tbody></table>
<h3 id="list"><a href="#list" class="headerlink" title="list"></a>list</h3><pre class="language-none"><code class="language-none">.&#x2F;bin&#x2F;flink list [OPTIONS]</code></pre>
<table>
<thead>
<tr>
<th>OPTIONS</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>–all 显示所有应用和对应的job id</td>
</tr>
<tr>
<td>-r</td>
<td>–running 显示正在运行的应用和job id</td>
</tr>
<tr>
<td>-s</td>
<td>–scheduled 显示调度的应用和job id</td>
</tr>
<tr>
<td>-m</td>
<td>–jobmanager 指定连接的jobmanager</td>
</tr>
<tr>
<td>-yid</td>
<td>–yarnapplicationId 挂到指定的yarn id对应的yarn session上</td>
</tr>
<tr>
<td>-z</td>
<td>–zookeeperNamespace 用来创建ha的zk子路径的命名空间</td>
</tr>
</tbody></table>
<h3 id="stop"><a href="#stop" class="headerlink" title="stop"></a>stop</h3><pre class="language-none"><code class="language-none">.&#x2F;bin&#x2F;flink stop  [OPTIONS] &lt;Job ID&gt;</code></pre>
<table>
<thead>
<tr>
<th>OPTIONS</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>在采取保存点和停止管道之前，发送MAX_WATERMARK</td>
</tr>
<tr>
<td>-p</td>
<td>savepointPath 保存点的路径 ‘xxxxx’</td>
</tr>
<tr>
<td>-m</td>
<td>–jobmanager 指定连接的jobmanager</td>
</tr>
<tr>
<td>-yid</td>
<td>–yarnapplicationId 挂到指定的yarn id对应的yarn session上</td>
</tr>
<tr>
<td>-z</td>
<td>–zookeeperNamespace 用来创建ha的zk子路径的命名空间</td>
</tr>
</tbody></table>
<h3 id="cancel-弱化"><a href="#cancel-弱化" class="headerlink" title="cancel(弱化)"></a>cancel(弱化)</h3><pre class="language-none"><code class="language-none">.&#x2F;bin&#x2F;flink cancel  [OPTIONS] &lt;Job ID&gt;</code></pre>
<table>
<thead>
<tr>
<th>OPTIONS</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>-s</td>
<td>使用 “stop “代替</td>
</tr>
<tr>
<td>-D</td>
<td>允许指定多个通用配置选项</td>
</tr>
<tr>
<td>-m</td>
<td>要连接的JobManager的地址</td>
</tr>
<tr>
<td>-yid</td>
<td>–yarnapplicationId 挂到指定的yarn id对应的yarn session上</td>
</tr>
<tr>
<td>-z</td>
<td>–zookeeperNamespace 用来创建ha的zk子路径的命名空间</td>
</tr>
</tbody></table>
<h3 id="savepoint"><a href="#savepoint" class="headerlink" title="savepoint"></a>savepoint</h3><pre class="language-none"><code class="language-none">.&#x2F;bin&#x2F;flink savepoint  [OPTIONS] &lt;Job ID&gt;</code></pre>
<table>
<thead>
<tr>
<th>OPTIONS</th>
<th>功能说明</th>
</tr>
</thead>
<tbody><tr>
<td>-d</td>
<td>要处理的保存点的路径</td>
</tr>
<tr>
<td>-j</td>
<td>Flink程序的JAR文件</td>
</tr>
<tr>
<td>-m</td>
<td>要连接的JobManager的地址</td>
</tr>
<tr>
<td>-yid</td>
<td>–yarnapplicationId 挂到指定的yarn id对应的yarn session上</td>
</tr>
<tr>
<td>-z</td>
<td>–zookeeperNamespace 用来创建ha的zk子路径的命名空间</td>
</tr>
</tbody></table>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">John Doe</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://example.com/2022/01/19/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/">http://example.com/2022/01/19/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="/about" target="_blank">John Doe</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/linux/">
                                    <span class="chip bg-color">linux</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
                <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.4rem;
        line-height: 38px;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fas fa-times"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>

            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2022/01/20/%E4%BA%8B%E5%AE%9E%E8%A1%A8%E7%9A%84%E7%B1%BB%E5%9E%8B/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/15.jpg" class="responsive-img" alt="事实表的类型">
                        
                        <span class="card-title">事实表的类型</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2022-01-20
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/%E6%95%B0%E4%BB%93/" class="post-category">
                                    数仓
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/%E6%95%B0%E4%BB%93/">
                        <span class="chip bg-color">数仓</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2022/01/09/%E4%B8%80%E6%9C%88%E6%9D%82%E9%A1%B9/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="">
                        
                        <span class="card-title"></span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2022-01-09
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            John Doe
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="503838841"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="/libs/aplayer/Meting.min.js"></script>

    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2022</span>
            
            <a href="/about" target="_blank">John Doe</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;Total visitors:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:1181062873@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1181062873" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 1181062873" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="/libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    
    <script async src="/libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
